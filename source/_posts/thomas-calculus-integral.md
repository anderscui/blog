---
title: Thomas' Calculus - 积分
date: 2017-08-14 00:35:35
tags:
	- Maths
---

# 积分

我们已经看到计算**瞬时变化率**的需要是如何导致人们研究切线的斜率，并引出我们称之为**微分运算**的**导数**。但导数揭示的仅仅是故事的一半，微积分除了描述函数在给定时间如何变化，还要描述那些瞬时的变化如何在一段时间内累积而产生该函数。也就是**通过研究行为的改变来了解行为本身**。例如，运动物体的速度能够决定作为时间函数的位置，人们还研究了曲边梯形的面积，这些研究导致产生了我们称之为**积分学**。

曾经，人们觉得求切线斜率和曲边梯形没有任何联系。牛顿和莱布尼兹却证明了凭直观发现的两者之间的内在联系。这个联系（微积分基本定理）的发现使得微分和积分运算**一起成为数学家总能得到认识宇宙万物的最有力的工具**。	

## 不定积分、微分方程和建模

第一部分主要讨论的是求一个函数的导函数，一个自然的问题是，给定一个函数，如何求得它的**反导数（原函数）**，即以它为导数的函数。

第一步是给出一个公式，该公式被称为**不定积分**，它给出了所有可能的反导数。第二步则是利用手头已知的函数值来选定一个特殊的反导数。

看起来这只是一个“理论上”的思路，因为要以一个公式给出所有反导数，似乎不大可能。但根据3.2的中值定理的推论，只要找到一个反导数，就能确定出**不定积分**了。

### 不定积分

一个函数$F(x)$称为另一个函数$f(x)$的**反导数**，如果

$$F'(x) = f(x)$$

对$f$定义域中的$x$成立。$f$的全体反导数组成的集合称为其关于$x$的**不定积分**，记作

$$\int f(x)dx$$

其中$f$称为**被积函数**，$x$称为**积分变量**。

按3.2中值定理推论，已知一个反导数$F(x)$，那么其它反导数与其仅相差一个常数，故有

$$\int f(x)dx = F(x) + C$$

其中$C$称为**积分常数**或**任意常数**。

例：$\int 2xdx = x^2 + C$

我们可以把导数公式表反过来作为初始的“反导数公式”表使用。

### 初值问题

已知函数的导数以及在一点$x_0$处的值$y_0$，求$x$的函数$y$的问题称为**初值问题**。

例：已知曲线在点$(x, y)$处的斜率为$3x^2$，并通过点$(-1, 1)$，求该曲线。

解：$\int 3x^2dx = x^3 + C$，又因为曲线通过点$(-1, 1)$，可知$C = -2$，故所求曲线为$y = x^3 - 2$。

如上，不定积分给出了微分方程的**一般解**，借由初值我们可以确定出**特解**。

### 数学建模

一般步骤：

* 观察现实世界行为
* 为确定变量及其关系作出假设，建立模型
* 求解模型得到数学解
* 解释模型并将其与现实世界的观察对照

## 积分法则与替换积分法

现在知道，要求不定积分，就是找出”一个“反导数，再加上积分常数即可。寻找反导数时，最简单的情形就是直接对应导数表的情形。略复杂的则是采用反导数的代数法则，这个可以通过导数的代数法则推导而来。

例：求$\sin^2x$的积分

解：$\int \sin^2xdx = \int \frac{1-\cos2x}{2}dx = \frac{x}{2} - \frac{\sin2x}{4} + C$

### 积分形式的幂法则

若$u$是$x$的可微函数，那么由链式法则有$\frac{d}{dx} (\frac{u^{n+1}}{n+1}) = u^n \frac{du}{dx}$，反过来即有

$$\int (u^n \frac{du}{dx})dx = \frac{u^{n+1}}{n+1} + C$$

等式左边可以用更简单的**微分**形式：$\int u^ndu$，这里将$\frac{du}{dx} dx$写成$du$像是把$dx$给抵消了。也可以这样理解，$du = u'dx = \frac{du}{dx}dx$。关键是，转化为这种形式后，就可以看作是直接求关于$u$的积分。

例：$\int \sqrt{1+y^2} \cdot 2ydy = \int u^{1/2}du = \frac{2}{3}u^{3/2} + C = \frac{2}{3}(1+y^2)^{3/2} + C$

此法则实际上给出了一种更通用的积分法，即链式法则的逆用。其关键是找出一个合适的中间函数$u$，将原积分转换为关于$u$的积分，而且后者更容易求解。这就是**替换法**。

### 替换积分法

上述思想之推广。

## 用有限和估计（Estimating with finite sums）

用有限和估计，我们最熟悉的大概是求曲线所围的图形之面积，或是求圆的面积，球体的体积之类的问题。另外，考虑通过速度函数求位移，和面积本质上也是一样的。这些问题都是先将区间切分为几个小区间，然后在每个小区间上取某个点的函数值，求其于区间长度之乘积，然后再求和。这个”和“是真实值的近似值，而且当切分地越来越细时，误差也会减少。这就是为什么称之为**有限和估计**。

再来看一个不那么明显的问题。假设有一个非负函数，比如$y = x^2$，那么它在闭区间$[-1, 1]$上是否有**平均值**？

一般而言，平均值所涉乃是有限个值的算数平均值，那么对于连续区间上的值来说，平均是什么意思呢？如果我们考虑对函数值随机抽样，从值域中随机抽取相当多个值，那它们的平均值是不是可以算作**平均值**的近似呢？这样，我们不妨认为平均值是有意义的。一旦有了意义，那么实际上函数平均值还可以有更直观的理解。我们把原曲线与数轴所围之图形归约为同面积的矩形，平均值就是该矩形的**宽**，矩形的长已知，而矩形的面积等于曲线梯形的面积，此面积可由上述有限和估计的思路求得，如此一来，平均值可用面积除以区间长度而得到！这确实是很让人意外的结果：）

综上，不论是面积、位移还是平均值，我们都把问题归结为同一个问题：**函数值乘以子区间长度之和**。该有限和随着子区间的细分而越发精确。在位移问题中，一段时间的位移，可以通过先求速度函数的反导数，在代入反导数求值得到。那么这一类问题与反导数的关系是巧合吗？反导数是否也可用于面积与平均值问题？答案当然是肯定的：）

例：通过正多边形面积估计圆的面积，圆取单位圆，其面积为$\pi$，多边形的边数取4、8、16这样。

解：圆的内接正多边形面积可用下面的函数表示（Python）

```python
import math
def s(n):
    theta = 2 * math.pi/n
    return 0.5 * n * math.sin(theta)
     
for i in range(2, 16):
    n = 2 ** i
    print(n, area(n))
```

```shell
4 2.0
8 2.82842712474619
16 3.0614674589207183
32 3.121445152258052
64 3.1365484905459393
128 3.140331156954753
256 3.141277250932773
512 3.141513801144301
1024 3.1415729403670913
2048 3.1415877252771596
4096 3.1415914215111997
8192 3.1415923455701176
16384 3.1415925765848725
32768 3.1415926343385627
```

可以看到多边形的面积确实是越来越接近圆面积的。

## 黎曼和与定积分

上述的**有限和估计**中，和中的项由选择的函数值乘以子区间长度而得。那么怎样让估计的误差越来越小？甚至是能否求出准确值？本节来考虑这些问题，由有限和的定义出发，所考虑的两点是：让子区间越来越小趋近于零，选择的函数值对最终值有何影响？

### 黎曼和

我们感兴趣的**有限和**是**黎曼和**，以伟大的数学家黎曼（Riemann）命名。现在给出黎曼和的准确定义。

$f(x)$是定义在闭区间$[a, b]$上的任意连续函数。将区间分割为$n$个子区间，$a$和$b$之间的分点记作$x_1, x_2, \cdots,x_{n-1}$，它们依次递增。为统一起见，记$a$为$x_0$，$b$为$x_n$，那么集

$$\{ x_0, x_1, \cdots, x_n \}$$

称为$[a, b]$的一个**划分**。划分$P$定义$n$个闭子区间

$$[x_0, x_1], [x_1, x_2], \cdots, [x_{n-1}, x_n]$$

$[x_{k-1}, x_k]$称为$P$的**第$k$个子区间**，其长度为$\Delta x_k = x_k - x_{k-1}$。

在每个子区间中，我们选择某个数，以$c_k$表示从第$k$个子区间中所选者。在每个子区间上，竖起一个垂直矩形，立于$x$轴，在$(c_k, f(x_k))$点接触曲线（与曲线相交，但在子区间上并不限于此一交点）。

在每个子区间上，作乘积$f(c_k) \cdot \Delta x_k $，乘积符号取决于$f(c_k)$。

最后，对乘积求和，$s_n = \displaystyle\sum_{k=1}^{n} f(c_k) \cdot \Delta x_k$。这个依赖于**划分**$P$和数$c_k$的选择的**和**是$f$在区间$[a, b]$上的**黎曼和**。

其中步骤可以总结为：

1. 作**划分**
2. 在每个子区间上**选择数**
3. 在每个子区间上**作乘积**
4. 对乘积求和

随着划分不断变细，我们期望由划分确定的诸举行逼近$x$轴与$f$曲线之间区域的精度随之提高。与正多边形逼近圆的面积类似，**我们期望该黎曼和有一个极限值**。

求函数极限时，我们说$x$与$x_0$距离越来越小，那么对于黎曼和来说，我们需要**划分不断变细**。定义最长子区间的长度为划分的**模**，记为$||P||$，那么要求黎曼和的极限，我们需要$||P||$趋于零。如果该极限确实存在，那么称为**定积分**。

### 定积分

**定义**：设$f(x)$是定义在闭区间$[a, b]$上的一个函数，对于区间上的任意划分$P$，设$c_k$是$P$的第$k$个子区间上任意选取的数。如果存在一个数$I$，使得不论$P$和$c_k$如何选择，都有

$$\lim_{||P|| \to 0} \displaystyle\sum_{k=1}^{n} f(c_k) \Delta x_k = I$$

则称$f$在$[a, b]$上是**可积的**，而$I$称为$f$在区间$[a, b]$上的**定积分**。

黎曼和和定积分的定义没有告诉我们如何确定定积分是否存在，故下面的定理非常有用：

**定积分的存在性**：

所有连续函数是可积的，即如果一个函数在$[a, b]$上是连续的，那么它在该区间上的定积分存在。

### 定积分表示

按莱布尼兹的记号，上述由黎曼和极限表示的定积分可以表示为

$$\int_{a}^{b} f(x)dx$$

读作”从$a$到$b$，$f(x)dx$的积分“，或”从$a$到$b$，$f(x)$对于$x$的积分“。$a$、$b$分别称为积分，$f(x)$为**被积函数**，$x$是**积分变量**。

函数在任何特定区间上的定积分值依赖于函数而不依赖于表示其自变量的字母。对于同一函数$f$，不论积分变量是$x$还是$t$，其结果都是同一个数。故积分变量称为**哑元**。

### 定积分与曲面梯形之面积

现在再考虑之前以有限和估计面积，会发现小矩形面积之和正是**黎曼和**。那么对于在$[a, b]$上可积的非负函数来说，该区间对应的**曲线下的面积定义为定积分的值**。

有了这一定义，我们可以从面积计算积分，反之亦然。

### 函数平均值

类似地，可以定义**函数的平均（中）值**：

若$f$在$[a, b]$上可积，则它在$[a, b]$上的平均值是

$$av(f) = \frac{1}{b-a} \int_{a}^{b} f(x)dx$$

### 定积分的性质

在定积分的定义中，由于它定义在闭区间上，那么自然地上限大于下限。但我们可以将定义扩展到上限小于或等于下限的情形：

* $\int_{a}^{b}f(x)dx = -\int_{b}^{a}f(x)dx$
* $\int_{a}^{a}f(x)dx = 0$

以面积来思考，可以从直观上得到其它几条性质

* 可加性：$\int_{a}^{b}f(x)dx + \int_{b}^{c}f(x)dx = \int_{a}^{c}f(x)dx$
* 最大-最小表达式
* 控制：$f(x) \geq g(x) \Rightarrow \int_{a}^{b}f(x)dx \geq \int_{a}^{b}g(x)dx$

## 中值定理与基本定理（The mean value and fundamental theorems）

本节介绍**积分学的两个最重要的定理**，即定积分的中值定理和基本定理。基本定理至今仍被看作**历史上最重要的计算方面的发现**。

### 中值定理

定理：如果$f$在$[a, b]$上连续，则在$[a, b]$中的某点$c$有

$$f(c) = \frac{1}{b-a} \int_{a}^{b}f(x)dx$$

证：由积分的最大-最小法则有$\min f \leq \frac{1}{b-a} \int_{a}^{b}f(x)dx \leq \max f$

因为$f$是连续的，根据**连续函数的中值定理**可知，必定存在$[a, b]$中的某点$c$可以取到所要求的函数平均值。

该定理的**连续性**是关键。

### 微积分基本定理的第一部分

如果$f$是一个可积函数，那么从固定数$a$到另一数$x$的积分定义一个函数$F$，它的值是

$$F(x) = \int_{a}^{x}f(t)dt$$

$F$由定积分表达式表示，但这确实是一个有效的函数定义。对于每一个$x$，均有唯一确定的值与之对应，此函数值即相应的定积分——一个数字。这个函数的定义与迄今所见的通常的函数定义相比，有点奇怪，但它是极为重要的，因为它建立起了积分和导数之间的联系，这就是**基本定理的第一部分**：

如果如果$f$在$[a, b]$上连续，则函数

$$F(x) = \int_{a}^{x}f(t)dt$$

在$[a, b]$的每个点$x$都可导，且

$$\frac{dF}{dx} = \frac{d}{dx} \int_{a}^{x}f(t)dt = f(x)$$

也就是说$F(x)$的导数为$f(x)$。这一结论无疑是优美、深刻且令人惊异的，而该等式也成为数学中最重要的等式之一。它告诉我们每个连续函数必然是另一个函数的导数，它说明了积分和微分的过程是可逆的。

注意：这里等式$a$没有出现，这意味着无论积分下限取什么值，等式都成立。

例：$\frac{d}{dx} \int_{-p}^{x} costdt = \cos x$

$\int_{a}^{x}f(t)dt$是关于$x$的函数，尽管形式上与之前所见不太寻常，但我们大可以将其看作某个函数$F(x)$，它本质上就是一个寻常的函数。

例：求$y = \int_{1}^{x^2} \cos t dt$的导数。

解：此函数可以看作$F(x) = \int_{1}^{x} \cos t dt$与$u = x^2$的复合函数，应用链式法则得到：

$$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = \cos u \cdot \frac{du}{dx}$$

$$ = cos(x^2) \cdot 2x = 2x \cos x^2$$

基本定理的第一部分证明这里从略，只提一下可以用定积分的中值定理证明。

### 微积分基本定理的第二部分

应用导数的中值定理推论2，可以证明**微积分基本定理的第二部分**：如果$f$在$[a, b]$的每个点连续，而$F$是$f$在$[a, b]$的任何一个反导数，则有

$$\int_{a}^{b} f(x)dx = F(b) - F(a) = \left.F(x)\right|_a^b$$

这一等式的形式很简单，但它的威力却是极强的。本来定积分的定义来自于黎曼和的极限，而要求这个极限是颇为繁琐的，涉及划分、函数值的选取和极限的求值，变化颇多，但这一等式却把整个过程简化为反导数的求解这一问题。无怪乎这个等式成为”基本定理“的一部分了。

### 面积计算

有了基本定理，面积的求解就成为了一个”计算“问题，只是要注意定积分不会区分”正面积“与”负面积“，一般我们所说的”面积“是两种面积绝对值之和，因此需要先确定负面积之区间。

## 定积分的变量替换（Substitution in Definite Integrals）

根据基本定理第二部分，求解定积分时，可以先求不定积分，这样不定积分的各种方法就用得上了，比如”替换积分法“。

另一方面，对定积分而言，它还可以直接应用变量替换。即：

$$\int_{a}^{b} f(g(x)) \cdot g'(x) dx = \int_{g(a)}^{g(b)} f(u) du$$

也就是说，变量替换之后，我们只要求新的（期望是简化了的）函数的积分，其积分上下限需要做相应的修改。

例：求$\int_{-1}^{1} 3x^2 \sqrt{x^3+1}dx$

解：令$u = x^3 + 1$，则原积分等于$\int_{0}^{2}\sqrt{u}du = \frac{4\sqrt{2}}{3}$。

作为一种选择，可以先求反导数再行计算。虽然在本例中，定积分的变量替换更简单，但并不总是如此，因此这两种方法都需要了解。

### 曲线之间的面积

若$f$和$g$连续且在$[a, b]$上有$f(x) \geq g(x)$，则在从$a$到$b$的两条曲线之间区域的面积是：

$$A = \int_{a}^{b}(f(x) - g(x))dx$$

## 数值积分

根据基本定理，对定积分求值时，最理想的方式是先求反导数再代入计算，但某些函数的反导数难以计算，甚至像$\frac{\sin x}{x}$和$\sqrt{1+x^4}$的反导数没有初等表达式。

当我们不能直接用反导数求出定积分的值时，我们转向梯形法和Simpson法这样的**数值方法**。

### 梯形法

在考虑有关定积分的问题时，用面积问题来获取直观理解是很有帮助的。求定积分即求曲边梯形的面积，如果我们把区间划分为多个小区间，那么在每个小区间上可以用简单曲线来近似原曲线。那么最简单的曲线就是直线了，采用直线近似时，在每个小区间上，用梯形面积近似原来的小曲边梯形的面积。当划分足够细，我们期望其误差足够小。

此方法除了可以直接应用于面积计算，也可以用于由离散值计算面积的近似值，因为若干连续分布的函数值，恰好是帮我们作好了一个划分：）比如有温度统计来计算一段时间的平均温度。

梯形法的误差分析从略。

### 抛物线逼近（Simpson法）

在上述面积近似问题中，如果我们用比直线复杂的抛物线来求近似值，我们期望误差会更小，这就是**抛物线逼近法**。

## 扩展

### 莱布尼兹法则

$$\frac{d}{dx} \int_{u(x)}^{v(x)} f(t)dt = f(v(x)) \frac{dv}{dx} - f(u(x)) \frac{du}{dx}$$

证：设$F$是$f$的一个反导数，那么$\int_{u(x)}^{v(x)} f(t)dt = F(v(x)) - F(u(x))$，对等式右边求导，应用链式法则即得到所需结论。

# 积分的应用

从上章可见，积分用于函数”累积之效“类型的问题颇具威力，无论是面积、体积，还是位移等等。其基本之法，在于**以黎曼和之形式表示欲求解之问题**，从而转化为定积分问题。本章将在此思路上引介几种新类型的问题，亦可见积分应用之广泛。

## 切片法求体积和绕轴旋转

恰如矩形之于曲线面积，若以柱体近似体积，则有立体体积之定义：

已知从$x = a$到$x = b$横截面积$A(x)$的立体，如果$A(x)$可积，那么立体的体积是$V = \int_{a}^{b} A(x)dx$。

在由小柱体近似立体体积时，就像将原立体切分为若干小的切片儿，此为**切片法**一名之由来。另外，由此定义可以立即得出中学几何中的**卡瓦列里原理（祖暅原理）**。

### 旋转体之体积

若一立体由一图像旋转所得，如球体，圆锥体之类，则容易将此类立体的体积求解转化为上面的切片法基本定义。因为旋转体的横截面积容易求得。

略复杂一点的情形是，曲线可以沿$x$轴之外的点直线旋转，如$y$轴或平行于$y$轴的直线等，其思路是一样的。

再复杂一点的是**垫圈形**横截面。此时横截面是一个圆环，还是可以求出来。

## 以圆柱薄壳模式计算体积

如果对$y$的积分不易计算，可转而考虑圆柱薄壳方法，这个方法比较巧妙，但仍是**黎曼和**的思路。

## 平面曲线的长度

你有没有想过，一个正弦波有多长？波长的通常意义是波的基本周期，对于$y = \sin x$来说是$2 \pi$。那么现在再次祭出我们的**黎曼和**来，看看能否解决之。

先作区间的一个划分，每个小区间上，曲线的长度如何近似？首先可以考虑的就是两个端点见的割线长度，割线的长度是$\sqrt{\Delta x_k^2 + \Delta y_k^2}$。这一形式还不是我们熟悉的黎曼和，我们需要将其表示为$f(c_k)\Delta x_k$的形式，通过变形有如下等式：

$$\sqrt{\Delta x_k^2 + \Delta y_k^2} = \sqrt{1 + (\frac{\Delta y_k}{\Delta x_k})^2} \Delta x_k$$

而根据可微函数的中值定理，小区间上存在点$c_k$，使得$\frac{\Delta y_k}{\Delta x_k} = sin'c_k$，这样就得到了黎曼和。最终我们要求的波长为定积分：

$$\int_{0}^{2\pi} \sqrt{1+(sin'x)^2}dx \approx 7.64$$

注：在对一般函数应用上述计算过程时，函数需满足两个条件。首先函数是**可微的**，此外欲求积分，还要求函数的**导函数是连续的**。总之，此法求解曲线长度的要求是**函数有连续的一阶导数**。这一要求称为**光滑**，中学时所接触的函数都是光滑的，所以那时候老师总是说，要以光滑的曲线连接起几个点了，这就是其依据了。

其它长度形式暂从略。

## 弹簧、泵吸和提升；流体力；矩和质心

此三节内容不甚熟悉，暂亦不需要，从略。

# 超越函数（Transcendental Functions）和微分方程（Differential Equations）

至此我们对有理函数、三角函数的导数和积分有了一定了解，接下来就是极重要的对数函数和指数函数。函数$y = \ln x$在中学里只是一种特殊的对数函数，但学习了积分后，我们可以以另一种方式定义它，其中隐含的数学概念间的关联是让人颇感新奇的。

## 对数

**定义**：正数$x$的自然对数，记作$\ln x$，是一个积分值：

$$\ln x = \int_{1}^{x} \frac{1}{t}dt, x > 0$$

注意到被积函数总是取正值的。若$x > 1$，$\ln x$是曲线下区域的面积；若$0 < x < 1$，$\ln x$给出曲线下面积之负值；若$x \leq 0$，则函数无定义。还有，$\ln 1 = 0$

### 对数函数的导数

根据基本定理，易得自然对数函数的导数，即：

$$\frac{d}{dx} \ln x = \frac{1}{x}$$

所以导数总为正，函数在定义域内是递增的，二阶导数则恒为负，$\ln x$的图像是凹向下的。

进一步，由链式法则可知，复合函数$\frac{d}{dx}\ln u = \frac{1}{u} \frac{du}{dx}$。

下面是对数的三个法则：

* $\ln ax = \ln a + \ln x$
* $\ln \frac{a}{x} = \ln a - \ln x$
* $\ln x^n = n \ln x$

###  $\int (1/u)du$的积分

看起来有点无赖，但我们将积分定义为对数函数后，这一类函数的积分就有了显式的表达式了，是故：

$$\frac{1}{u} = \ln |u| + C$$

到这里，所有形如$u^ndu$的积分都可以求解了，其中包括了$\tan x$和$\cot x$：

* $\int \tan x dx = \ln |\sec x| + C$
* $\int \tan x dx = -\ln |\csc x| + C$

### 对数微分法

在表达式涉及指数式，对数可将其大幅度简化为几个对数的四则运算，辅之以链式法则，这就是**对数微分法**。

例：求$y = \frac{(x^2+1)(x+3)^{1/2}}{x-1}$的导数。

解：$\ln y = \ln (x^2+1) + \frac{1}{2}\ln (x+3) - \ln (x-1)$，余略。

### $\log_a u$的导数

先采用换底公式将其转换为自然对数，它只比自然对数多了一个常系数。

## 指数函数

中学数学中，对数函数定义为指数函数的反函数。现在对数函数借由积分定义了出来，指数函数定义为对数函数的反函数。在导数已经提及，一个函数与其反函数存在着一定的关系，即：

$$(f^{-1})' = \frac{1}{f'}$$

需要注意的是，$f$上的点$(a, f(a))$对应于$f^{-1}$上的$(f(a), a)$。

函数$\ln x$定义域为全体正实数，且是增函数，那么它有自己的反函数。我们把$\ln^{-1} 1$用$e$表示。

$e$是一个无理数，且是超越数。

### 自然指数函数

$e$是一个正实数，那么我们可以定义以它为底的指数函数$y = e^x$。对其求对数，有：

$$\ln e^x = x \ln e = x$$

所以$y = e^x$实际上就是$y = \ln x$的反函数。

### $e^x$的导数与积分

使用对数积分法，可以得到一个结论：

$$\frac{d}{dx} e^x = e^x$$

注：[超越数](https://zh.wikipedia.org/zh-cn/%E8%B6%85%E8%B6%8A%E6%95%B8)

### $a^x$的导数与积分

根据对数函数的性质，$a^x = e^{x \ln a}$，所以一般指数函数的导数可以转化为自然指数的导数：

$$\frac{d}{dx}a^x = \ln a a^x$$

由此可知，若$a > 1$，那么导数为正，函数递增，否则导数为负，函数递减。而二阶导数恒为正，所以指数函数总是凹向上的。

由上述导数可求得指数函数的积分：

$$\int a^xdx = \frac{1}{\ln a}a^x + C$$

例：求$\int \frac{dx}{1+e^x}$

解：令$u = 1 + e^x$，则有$dx = \frac{du}{u-1}$，同时利用等式$\frac{1}{u} \cdot \frac{1}{u-1} = \frac{1}{u-1} - \frac{1}{u}$可解。

## 反三角函数的导数与积分

反三角函数在数学、物理与工程上应用颇为广泛，本节讨论其导数与积分。上节提到对数微分法，反三角函数的导数求解起来也有类似思路。

### 反三角函数的导数

$y = \sin^{-1} x$，故$\sin y = x$，两边求导有：

$$\frac{dy}{dx} = \frac{1}{\cos y} = \frac{1}{\sqrt{1-x^2}}$$

类似地，$\frac{d}{dx}(\tan^{-1} x) = \frac{1}{1+x^2}$，$\frac{d}{dx}(\sec^{-1} x) = \frac{1}{|x|\sqrt{x^2-1}}$

对另外三个反三角函数（余..），利用它们与上面三个（正..）函数的关系可知，它们的导数是相对应函数导数的负值。

### 反三角函数的相关积分

从导数反推过来，得到：

* $\int \frac{du}{\sqrt{a^2 - u^2}} = \sin^{-1}(\frac{u}{a}) + C$
* $\int \frac{du}{a^2 + u^2} = \frac{1}{a} \tan^{-1}(\frac{u}{a}) + C$
* $\int \frac{du}{u\sqrt{u^2 - a^2}} = \frac{1}{a} \sec^{-1}|\frac{u}{a}| + C$

## 一阶可分离变量微分方程

（Linear First Order Differential Equations）

在初次接触隐函数求导法时会发现，导数$\frac{dy}{dx}$的表达式中经常同时包含变量$x$和$y$，本节讨论的初值问题中就包含此类形式的导数。

**一阶微分方程**是关系

$$\frac{dy}{dx} = f(x, y)$$

方程右边是一个二元函数。此方程的一个**解**是定义在关于$x$值的一个区间上的可微函数$y(x)$，使得在此区间上

$$\frac{dy}{dx} = f(x, y(x))$$

例：函数$y = \frac{1}{x} + \frac{x}{2}$是方程$\frac{dy}{dx} = 1 - \frac{y}{x}$的一个解。

### 可分离变量方程

方程$y' = f(x, y)$是**可分离变量**的，如果$f$可表示为一个$x$的函数与一个$y$的函数的乘积。此时方程有形式

$$\frac{dy}{dx} = g(x)h(y)$$

若$h(y) \neq 0$，那么

$$\frac{1}{h(y)}\frac{dy}{dx} = g(x)，两边取积分$$

$$\int \frac{1}{h(y)}\frac{dy}{dx} dx = \int g(x)dx，即$$

$$\int \frac{1}{h(y)}dy = \int g(x)dx$$

此时$x$和$y$已经分离，接下来积分两端，把$y$表示为$x$的显函数或隐函数。

## 线性一阶微分方程

如果一阶微分方程可以写成形式

$$\frac{dy}{dx} + P(x)y = Q(x)$$

则它是**线性**一阶微分方程，此形式是它的**标准形式**。

例：把下面方程表示成标准形式：$x \frac{dy}{dx} = x^2 + 3y, x > 0$

解：方程可以变形为：$\frac{dy}{dx} - \frac{3}{x}y = x$，是为标准形式。

### 标准形式的解

线性方程

$$\frac{dy}{dx} + P(x)y = Q(x)$$

的解是

$$y = \frac{1}{v(x)} \int v(x)Q(x)dx$$

其中

$$v(x) = e^{\int P(x)dx}$$

在$v$的公式中，我们不需要$P(x)$的最一般形式的反导数，任一反导数都适用。

具体求解可参考书本。大体先使用**分部积分**的思路，使用一个未知的$v$辅助，而$v$本身的求解是一个较简单的可分离变量微分方程。

## Euler法

如果我们不需要或者不能够理解求得初值问题$y' = f(x, y), y(x_0) = y_0$的*精确解*，那么或许可以使用计算机产生一个表，列出在一个适当区间内的$x$值和对应的$y$的近似值，这样的一个表称为问题的**数值解**，而生成此表的方法称为**数值方法**。数值方法一般是快速和准确的。本节涉及的是**Euler法**。

### Euler法（Euler's Method）

给定微分方程$y' = f(x, y)$和初条件$y(x_0) = y_0$，我们可以用它的**线性化**

$$L(x) = y(x_0) + y'(x_0)(x - x_0)$$

来逼近解。函数$L$给出解在$x_0$附近的一个小区间上的好的逼近，Euler法的原理是把一系列线性化拼接起来以便在一个较长的区间上逼近曲线。这是一个迭代的过程，其结果是一条折线来近似原来解的曲线。

## 双曲函数（Hyperbolic Functions）

注：[双曲函数](https://zh.wikipedia.org/wiki/%E5%8F%8C%E6%9B%B2%E5%87%BD%E6%95%B0)

每个定义在以原点为中心的区间上的函数都能以唯一的方式写成一个偶函数和一个奇函数的和：

$$f(x) = \frac{f(x) + f(-x)}{2} + \frac{f(x) - f(-x)}{2}$$

在等式右边，第一部分是偶部分，第二部分是奇部分。如果以这种方式分写$e^x$，它的偶部分和奇部分分别称为**双曲余弦**和**双曲正弦**。它们都是有用的函数，可用以描述弹性固体中波的运动，悬挂的电能线的形状等。

### 定义

$$\cosh x = \frac{e^x + e^{-x}}{2}$$
$$\sinh x = \frac{e^x - e^{-x}}{2}$$

按一般三角函数的方式可以定义出另外四个双曲三角函数，更奇妙的是它们之间满足一些恒等式，看起来颇近于一般的三角恒等式。甚至连导数和积分也是如此。

然后也可以定义**反双曲函数**，它们的主要应用体现在积分中。比如我们有导数

$$\frac{d(\tanh^{-1} x)}{dx} = \frac{1}{1-x^2}$$

那么右侧看起来很简单的函数的积分就可由反双曲函数来表示了。


