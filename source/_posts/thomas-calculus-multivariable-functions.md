---
title: Thomas' Calculus - 多元函数及其微积分
date: 2017-09-18 01:24:01
tags:
	- Maths
---

# 多元函数及其导数
	- Multivariable Functions and Their Derivatives

在学习概率论和统计学的时候，我们会发现多元函数乃是更自然的存在，在其它学科如流体动力学和电学等领域亦是如此。本章就是介绍多元函数的，值得庆幸的是，在多元函数的情形，微积分的法则本质上保持原样。我们需要了解同一时间里各个方向上的变化，但我们要做的无非是**同时在各个方向上运用单变量微积分**。

# 多元函数
	- Functions of Several Variables

许多函数依赖多于一个的自变量。如$f(x, y) = x^2 + y^2$表示抛物面在点$P(x, y)$上方的高度。

## 二元函数

定义：**二元函数**

假定$D$是有序实数对$(x, y)$的集合，$D$上的**二元实函数$f$**是一个**规则**，它对$D$中的每一个有序对指定唯一的一个实数$w = f(x, y)$，$D$为**定义域**，$w$的取值集合为**值域**。

与一元函数相比，除了定义域略有不同，其它完全一致。

例：求函数的定义域和值域。

* $w = \sqrt{y - x^2}$：定义域是$y \geq x^2$，抛物线上方区域；值域是$[0, \infty)$
* $w = \sin xy$：定义域是全平面；值域是$[-1, 1]$

二元函数的定义域可以有**内点**和**边界点**，这跟一元函数区间的情形相似。

定义：**内点、边界点、开集合闭集**

$xy$平面上的集合$R$的一个点$(x_0, y_0)$是$R$的**内点**，如果它是一个含于$R$内的圆盘的中心。一个点$(x_0, y_0)$是$R$的**边界点**，如果每个以$(x_0, y_0)$为中心的圆盘有不属于$R$的点，也有不属于$R$的点（边界点本身不要求属于$R$）。

注：理解时，可类比于区间的内点与端点。

一个集合的内点全体构成其**内部**，边界点构成其**边界**。如果一个集合完全有内点构成，则称它为**开集**，如果一个集合包含它的所有边界点，则称之为**闭集**。

注：可类比于开区间、闭区间和半开半闭区间。

定义：有界集与无界集

一个平面集合是**有界的**，如果它包含在一个固定半径的圆盘里，否则是**无界的**。

## 二元函数的图像和等位线

**有两种标准化方法形象化一个函数$f(x, y)$的值**。一是**在定义域里**标注$f$有同一个值的曲线，即等位线，二是**在空间里**画曲面（与一元函数的曲线相对应）。

此外，**等高线**与等位线类似，很多时候不作区别。典型的等高线应用是地图，它可以看作是定义在经度纬度实数对上的函数。

### 计算机作图

在$Mathematica$中，可使用$Plot3D$作图：

```mathematica
Plot3D[Sin[x] Sin[y]^2, {x, 0, Pi}, {y, 0, Pi}]
```
## 三元及多元函数

二元函数的概念可以自然地推广到三元的情形。我们无法在三维框架内表示四维空间，但可考虑使用**等位面**来观察其行为。

内部、边界、有界性等概念也可以推广到三元函数。

最后，以上诸概念可以推广到$n$元函数$w = f(x_1, x_2, \cdots, x_n)$的情形。

# 高维函数的极限和连续
	- Limits and Continuity in Higher Dimensions

多元函数极限的定义类似于一元函数，但有一个颇重要的区别。

## 二元函数的极限

在一元函数的情形下，我们说$x$趋于某值，其意义是明确的，自变量沿着$x$轴向指定点靠近。二元情形下，“趋于”变得复杂，因为自变量可以从无数种可能的方向上靠近指定点。

定义：**二元函数的极限**

当$(x, y)$趋于$(x_0, y_0)$时，函数$f$有极限$L$，如果给定给定任意正数$\epsilon$，存在一个正数$\delta$，使得对所有在$f$定义域中且满足$0 < \sqrt{(x-x_0)^2 + (y - y_0)^2} < \delta$的点$(x, y)$有$|f(x, y) - L| < \epsilon$，写作

$$\lim_{(x, y) \to (x_0, y_0)} f(x, y) = L$$

看起来有些复杂，其实是完全等价于一元函数的情形，主要区别是，所考察的定义域范围由”区间“变为”圆盘“。另外，圆盘也可以换作”正方形“，即$0 < |x - x_0| < \delta, 0 < |y - y_0| < \delta$。

求一元函数时，需要考虑左、右两个方向，二元函数则需要多个不同的方向，若干不同方向（或曰路径）有不同的极限，那么函数极限不存在。这一点可作为**判别法**使用。

例：求函数$f(x, y) = \frac{2x^2y}{x^4+y^2}$趋于$(0, 0)$时的极限。

解：沿路径$y = kx^2, x \neq 0$，函数有常数值$\frac{2k}{1+k^2}$，这说明函数沿不同路径趋于$(0, 0)$有不同极限，故函数极限不存在。

### 极限性质

按惯例，常规的和、差、积、商、幂等法则都是适用的。

## 二元函数连续性

其定义与一元函数本质上是一样的，即函数在点$(x_0, y_0)$有定义，在该点极限存在，两者相等。

## 多于二元的函数

二元函数的极限、连续之定义，以及和、差、积、商、幂法则，以及复合函数的性质都可以推广到多于二元的函数。

## 有界闭集上连续函数的极值

一元连续函数在闭区间上的极值性质可以推广到多元连续函数的情形。在多元的情形下，**闭集**有多种不同的可能，在平面上，可以是线段、圆盘和填满的三角形等，在空间内，可以是球体、立方体或球壳等。

具体如何求解极值，在后面介绍了导数后会了解到。

# 偏导数
	- Partial Derivatives

对于多元函数，如果我们固定一个自变量之外的自变量，仅对这一自变量求导，就得到**偏（partial）导数**。

## 二元函数的偏导数

若$(x_0, y_0)$是函数定义域中一点，竖直平面$y = y_0$割曲面$z = f(x, y)$得到**曲线**$z = f(x, y_0)$。曲线在竖直平面内，成为关于$x$的一元函数，因此可以对其求出一般的导数。

定义：**关于$x$的偏导数**

在点$(x_0, y_0)$，$f(x, y)$对$x$的偏导数是

$\frac{\partial f}{\partial x} |_{(x_0, y_0)} = \frac{d}{dx}f(x, y_0)$

有时也记为$f_x(x_0, y_0)$。类似地，也可以定义$f(x, y)$对$y$的偏导数$f_y$。

现在来看，在$y = y_0$平面内，可由$f_x$找出过点$P(x_0, y_0, f(x_0, y_0))$的切线，在$x = x_0$平面内，可作出过$P$的另一切线，这两条切线确定的平面是否是函数曲面的切平面呢？这个问题的解答有赖于更多关于偏导数的知识。

注：函数对$x$和$y$的偏导数，可理解为函数在两个不同方向或路径上的切线斜率，因此两者的值不等就不足为怪了。

### 隐函数的偏导数

与一元函数的求解方法相同。

## 多于二元的函数

不管有几个自变量，所谓偏导数总是仅对**一个**自变量而言，因而本质上它可以理解为**一元函数**的导数。

## 偏导数与连续性

一个函数可以在一个点有对于$x$和$y$的偏导数，但在该点不连续，这与一元函数的情形不同。这个可以这么理解，偏导数仅说明了在两个方向上函数的变化特征，但连续性却包含了任意可能的方向。

## 二阶偏导数

对函数$f(x, y)$求导两次，就得到二阶导数。

$\frac{\partial^2f}{\partial x^2}$对$x$求导两次，$\frac{\partial^2f}{\partial x \partial y}$先对$y$求导，再对$x$求导。

定理：**混合导数定理**

若$f(x, y)$以及它的偏导数$f_x, f_y, f_{xy}, f_{yx}$定义在含点$(a, b)$的开集，且都在$(a, b)$连续，则

$$f_{xy}(a, b) = f_{yx}(a, b)$$

也就是说，在计算二阶混合导数时，可按任意次序微分，从而可以先选择较易进行的计算。

## 更高阶的偏导数

没有什么能够阻挡对更高阶偏导数的计算，而且它们依然遵循混合导数定理。

## 可微性

二元函数的可微性出发点不是**差商**，而是**增量**。一元函数中，当$x$从$x_0$改变到$x_0 + \Delta x$时，$f$的改变用等式

$$\Delta y = f'(x_0) \Delta x + \epsilon \Delta x$$

给出，其中当$\Delta x \to 0$时，$\epsilon \to 0$。

定理：**二元函数的增量定理**

假定$f(x, y)$的一阶偏导数在包含$(x_0, y_0)$的一个开集上有定义，并且$f_x$和$f_y$在$(x_0, y_0)$**连续**，则从$(x_0, y_0)$移动到$(x_0 + \Delta x, y_0 + \Delta y)$时引起的函数改变量$\Delta z$满足

$$\Delta z = f_x(x_0, y_0)\Delta x + f_y(x_0, y_0)\Delta y + \epsilon_1\Delta x + \epsilon_2\Delta y$$

其中，当$\Delta x, \Delta y \to 0$时，$\epsilon_1, \epsilon_2 \to 0$

定义：**二元函数的可微性**

一个函数$z = f(x, y)$在$(x_0, y_0)$是**可微的**，若$f_x(x_0, y_0)$和$f_y(x_0, y_0)$存在，且$\Delta z$满足

$$\Delta z = f_x(x_0, y_0)\Delta x + f_y(x_0, y_0)\Delta y + \epsilon_1\Delta x + \epsilon_2\Delta y$$

其中，当$\Delta x, \Delta y \to 0$时，$\epsilon_1, \epsilon_2 \to 0$。如果函数在定义域的每个点都是可微的，那么说函数是**可微的**。

增量定理的推论：**偏导数的连续性蕴含可微性**

定理：**可微性蕴含连续性**

# 链式法则

我们可以在**适当定义域**内复合多变量函数，这跟建立单变量函数的复合一样。一元函数的链式法则表示为

$$\frac{dw}{dt} = \frac{dw}{dx} \frac{dx}{dt}$$

定理：**二元函数的链式法则**

若$w = f(x, y)$是可微的，而$x$和$y$是$t$的可微函数，则$w$是$t$的可微函数，并且

$$\frac{dw}{dt} = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt}$$

TODO：定理5的证明需要再看一遍。

注：该定理的记忆可按照**树形图解**，该方法也适用于更高维的函数。

定理：**三元函数的链式法则**

若$w = f(x, y, z)$是可微的，而$x$、$y$和$z$是$t$的可微函数，则$w$是$t$的可微函数，并且

$$\frac{dw}{dt} = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt} + \frac{\partial f}{\partial z} \frac{dz}{dt}$$

注意到这两个链式法则最后都是一元的，如果是多于一元的，那么将有关于**偏导数**的链式法则，比如$x, y, z$到$r, s$，然后求$w$关于$r, s$的偏导数。又或者是一对多的情况，从$x$到$r, s$，那么也可以求$w$关于$r, s$的偏导数。

链式法则确然是**多才多艺的**，如此结论还有证据，即它还可以简化隐函数求导过程。

## 隐函数求导法

假定$F(x, y)$是可微的，并且方程$F(x, y) = 0$定义$y$为$x$的可微函数。则在$F_y \neq 0$的点，

$$\frac{dy}{dx} = - \frac{F_x}{F_y}$$

证：令$w = F(x, y) = 0$，此时可定义$y = h(x), x = x$，这样可应用链式法则，从而

$$\frac{dw}{dx} = F_x\frac{dx}{dx} + F_y\frac{dy}{dx} = 0$$

这样证明了**隐函数微分公式**。

## 链式法则小结

上面可以看到链式法则的不同应用场景，但它们都遵循同一个公式或思路。想象有一个树形结构，从因变量到中间变量再到自变量，为求得选定自变量的导数，从因变量开始，**往下读树的每条路径到自变量**，各条路径导数之和即为所求。


